<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NutriJosue - Your life Your way Your Diet</title>

<!-- Fuente bonita -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet" />

<style>
  /* Reset b치sico */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    font-family: 'Poppins', sans-serif;
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    user-select: none;
  }
  header {
    background: rgba(0,0,0,0.5);
    width: 100%;
    max-width: 1000px;
    padding: 20px 30px;
    border-radius: 10px;
    text-align: center;
    margin-bottom: 30px;
    box-shadow: 0 0 15px rgba(0,255,128,0.5);
  }
  header h1 {
    font-weight: 600;
    font-size: 3rem;
    color: #00ff80;
    margin-bottom: 10px;
    text-shadow: 0 0 10px #00ff80;
  }
  header p {
    font-weight: 300;
    font-size: 1.3rem;
    color: #ccffdd;
    font-style: italic;
  }
  main {
    background: rgba(0,0,0,0.55);
    max-width: 1000px;
    width: 100%;
    padding: 20px 30px;
    border-radius: 15px;
    box-shadow: 0 0 30px rgba(0,255,128,0.7);
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  .buttons {
    display: flex;
    justify-content: center;
    gap: 40px;
    margin-bottom: 15px;
  }
  button {
    background: linear-gradient(135deg, #00ff80, #005f30);
    border: none;
    color: #fff;
    font-weight: 600;
    font-size: 1.2rem;
    padding: 12px 25px;
    border-radius: 30px;
    cursor: pointer;
    box-shadow: 0 5px 15px rgba(0,255,128,0.6);
    position: relative;
    overflow: hidden;
    transition: background 0.3s ease;
  }
  button:hover {
    background: linear-gradient(135deg, #00ffa0, #008040);
  }
  /* Explosion animation */
  .explosion {
    position: absolute;
    border-radius: 50%;
    pointer-events: none;
    background: rgba(0, 255, 128, 0.7);
    animation: explode 0.5s ease forwards;
    mix-blend-mode: screen;
  }
  @keyframes explode {
    0% {
      transform: scale(0);
      opacity: 1;
    }
    100% {
      transform: scale(4);
      opacity: 0;
    }
  }

  /* 츼rea para mostrar la tabla y mensajes */
  #output {
    background: rgba(0, 0, 0, 0.65);
    border-radius: 10px;
    padding: 15px;
    min-height: 300px;
    color: #aaffcc;
    font-size: 1rem;
    overflow-x: auto;
  }

</style>
</head>
<body>
<header>
  <h1>NutriJB</h1>
  <p>Your life Your way Your Diet</p>
</header>

<main>
  <div class="buttons">
    <button id="btn-change-diet">Cambiar Comidas</button>
    <button id="btn-change-routine">Cambiar Rutina</button>
    <button id="btn-increase-difficulty">Subir dificultad</button>
  </div>

  <div id="output">
    <!-- Aqu칤 se mostrar치n las tablas de dieta y rutina -->
    <p>Bienvenido a NutriJosue! Usa los botones para generar tu plan personalizado.</p>
  </div>
</main>

<script>
  // Funci칩n para crear una peque침a explosi칩n animada en bot칩n
  function createExplosion(e) {
    const btn = e.currentTarget;
    const explosion = document.createElement('span');
    explosion.classList.add('explosion');
    const rect = btn.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    explosion.style.left = x + 'px';
    explosion.style.top = y + 'px';
    btn.appendChild(explosion);
    setTimeout(() => explosion.remove(), 500);
  }

  document.querySelectorAll('button').forEach(btn => {
    btn.addEventListener('click', (e) => {
      createExplosion(e);
    });
  });

  // Datos de ejemplo b치sicos para mostrar
  const sampleDiet = [
    { dia: 1, desayuno: "Huevos revueltos (150g)", comida: "Pollo a la plancha (200g)", cena: "Ensalada verde (150g)", snack: "Almendras (30g)" },
    { dia: 2, desayuno: "Avena con fruta (200g)", comida: "Pescado al horno (180g)", cena: "Verduras salteadas (150g)", snack: "Yogur natural (100g)" }
  ];

  const sampleRoutine = [
    { dia: 1, musculo: "Pecho y Tr칤ceps", ejercicios: ["Press de banca 12 repes 1min descanso", "Fondos 15 repes 1min descanso"] },
    { dia: 2, musculo: "Pierna y Abdomen", ejercicios: ["Sentadillas 15 repes 1min descanso", "Crunch abdominal 20 repes 45s descanso"] }
  ];

  // Funci칩n para mostrar dietas y rutina en output
  function mostrarPlan() {
    let html = `<h3>Plan de 2 d칤as de ejemplo</h3>`;
    html += `<table border="1" cellpadding="8" cellspacing="0" style="width:100%;color:#aaffcc;border-collapse:collapse;">
      <thead>
        <tr style="background:#003300;">
          <th>D칤a</th><th>Desayuno</th><th>Comida</th><th>Cena</th><th>Snack</th>
        </tr>
      </thead><tbody>`;
    sampleDiet.forEach(d => {
      html += `<tr>
        <td>${d.dia}</td>
        <td>${d.desayuno}</td>
        <td>${d.comida}</td>
        <td>${d.cena}</td>
        <td>${d.snack}</td>
      </tr>`;
    });
    html += `</tbody></table><br>`;

    html += `<h3>Rutina</h3>`;
    sampleRoutine.forEach(r => {
      html += `<strong>D칤a ${r.dia} - ${r.musculo}</strong><ul>`;
      r.ejercicios.forEach(ej => {
        html += `<li>${ej}</li>`;
      });
      html += `</ul>`;
    });

    document.getElementById('output').innerHTML = html;
  }

  // Mostrar plan inicial al cargar
  mostrarPlan();

  // Botones para cambiar comidas y rutina (placeholder funciones)
  document.getElementById('btn-change-diet').addEventListener('click', () => {
    alert('Funci칩n para cambiar comidas pronto disponible!');
  });
  document.getElementById('btn-change-routine').addEventListener('click', () => {
    alert('Funci칩n para cambiar rutina pronto disponible!');
  });
  document.getElementById('btn-increase-difficulty').addEventListener('click', () => {
    alert('Funci칩n para subir dificultad pronto disponible!');
  });
</script>
</body>
</html><div id="user-inputs" style="background: rgba(0,0,0,0.4); padding: 15px; border-radius: 10px; margin-bottom: 20px; color: #ccffcc;">
  <h2>Personaliza tu plan</h2>
  <form id="plan-form">
    <div style="display:flex; flex-wrap:wrap; gap:15px;">
      <label style="flex:1 1 150px;">
        Edad:<br/>
        <input type="number" id="age" min="10" max="100" required style="width:100%; padding:5px; border-radius:5px;"/>
      </label>
      <label style="flex:1 1 150px;">
        Peso (kg):<br/>
        <input type="number" id="weight" min="30" max="200" required style="width:100%; padding:5px; border-radius:5px;"/>
      </label>
      <label style="flex:1 1 150px;">
        Altura (cm):<br/>
        <input type="number" id="height" min="100" max="250" required style="width:100%; padding:5px; border-radius:5px;"/>
      </label>
      <label style="flex:1 1 150px;">
        Sexo:<br/>
        <select id="sex" required style="width:100%; padding:5px; border-radius:5px;">
          <option value="">Selecciona</option>
          <option value="male">Masculino</option>
          <option value="female">Femenino</option>
        </select>
      </label>
      <label style="flex:1 1 200px;">
        Objetivo:<br/>
        <select id="goal" required style="width:100%; padding:5px; border-radius:5px;">
          <option value="">Selecciona</option>
          <option value="loseFat">Bajar grasa (3 comidas)</option>
          <option value="gainMuscle">Subir m칰sculo (4 comidas)</option>
          <option value="maintain">Mantener peso (3 comidas)</option>
        </select>
      </label>
      <label style="flex:1 1 200px;">
        Presupuesto mensual ($):<br/>
        <input type="number" id="budget" min="1000" max="30000" required style="width:100%; padding:5px; border-radius:5px;"/>
      </label>
      <label style="flex:1 1 300px;">
        Tipo de deporte:<br/>
        <select id="sport" style="width:100%; padding:5px; border-radius:5px;">
          <option value="">Ninguno</option>
          <option value="cardio">Cardio</option>
          <option value="strength">Fuerza</option>
          <option value="mixed">Mixto</option>
          <option value="none">Ninguno</option>
        </select>
      </label>
    </div>

    <label style="margin-top:15px; display:block;">
      Alergias (separa con coma):<br/>
      <input type="text" id="allergies" placeholder="Ej: cacahuate, lactosa" style="width:100%; padding:5px; border-radius:5px;"/>
    </label>
    <label style="margin-top:15px; display:block;">
      Comidas que no te gustan (separa con coma):<br/>
      <input type="text" id="dislikes" placeholder="Ej: pescado, huevo" style="width:100%; padding:5px; border-radius:5px;"/>
    </label>

    <button type="submit" style="margin-top:20px; background: #00ff80; color:#000; font-weight:700; padding:10px 20px; border:none; border-radius:25px; cursor:pointer; box-shadow: 0 0 10px #00ff80;">
      Generar Plan
    </button>
  </form>
</div>

<script>
  // Arrays con comidas de ejemplo (puedes extender a 150 de cada tipo)
  const desayunos = [
    { nombre: "Huevos revueltos", gramos: 150, ingredientes: ["huevo"], precio: 20 },
    { nombre: "Avena con fruta", gramos: 200, ingredientes: ["avena", "fruta"], precio: 18 },
    { nombre: "Yogur con granola", gramos: 180, ingredientes: ["lactosa", "granola"], precio: 22 },
    { nombre: "Pan integral con aguacate", gramos: 120, ingredientes: ["gluten", "aguacate"], precio: 25 }
  ];
  const comidas = [
    { nombre: "Pollo a la plancha", gramos: 200, ingredientes: ["pollo"], precio: 40 },
    { nombre: "Pescado al horno", gramos: 180, ingredientes: ["pescado"], precio: 45 },
    { nombre: "Carne magra", gramos: 180, ingredientes: ["res"], precio: 50 },
    { nombre: "Ensalada mixta", gramos: 150, ingredientes: ["lechuga", "tomate"], precio: 20 }
  ];
  const cenas = [
    { nombre: "Ensalada verde", gramos: 150, ingredientes: ["lechuga", "pepino"], precio: 15 },
    { nombre: "Verduras salteadas", gramos: 150, ingredientes: ["verduras"], precio: 18 },
    { nombre: "Sopa de pollo", gramos: 200, ingredientes: ["pollo"], precio: 25 }
  ];
  const snacks = [
    { nombre: "Almendras", gramos: 30, ingredientes: ["almendra"], precio: 12 },
    { nombre: "Yogur natural", gramos: 100, ingredientes: ["lactosa"], precio: 18 },
    { nombre: "Fruta fresca", gramos: 150, ingredientes: ["fruta"], precio: 10 }
  ];

  // Ejercicios base para rutinas (cada grupo muscular con 20 ejercicios, aqu칤 2 por ejemplo)
  const ejerciciosPorGrupo = {
    pecho: [
      { nombre: "Press de banca", repeticiones: 12, descanso: "1 min" },
      { nombre: "Fondos", repeticiones: 15, descanso: "1 min" }
    ],
    tricep: [
      { nombre: "Extensiones de tr칤ceps", repeticiones: 12, descanso: "1 min" },
      { nombre: "Press cerrado", repeticiones: 12, descanso: "1 min" }
    ],
    pierna: [
      { nombre: "Sentadillas", repeticiones: 15, descanso: "1 min" },
      { nombre: "Zancadas", repeticiones: 12, descanso: "1 min" }
    ],
    abdomen: [
      { nombre: "Crunch abdominal", repeticiones: 20, descanso: "45 s" },
      { nombre: "Plancha", repeticiones: "1 min", descanso: "30 s" }
    ],
    espalda: [
      { nombre: "Remo con barra", repeticiones: 12, descanso: "1 min" },
      { nombre: "Dominadas", repeticiones: 10, descanso: "1 min" }
    ],
    hombro: [
      { nombre: "Press militar", repeticiones: 12, descanso: "1 min" },
      { nombre: "Elevaciones laterales", repeticiones: 15, descanso: "1 min" }
    ],
    cuello: [
      { nombre: "Flexiones de cuello", repeticiones: 15, descanso: "45 s" },
      { nombre: "Rotaciones de cuello", repeticiones: 20, descanso: "30 s" }
    ]
  };

  // Secuencia de grupos musculares por d칤a (d칤a 1: pecho+tr칤ceps, d칤a 2: pierna+abdomen, etc)
  const rutinaPorDia = [
    ["pecho", "tricep"],
    ["pierna", "abdomen"],
    ["espalda", "hombro", "cuello"],
    ["pecho", "tricep"],
    ["pierna", "abdomen"],
    ["espalda", "hombro", "cuello"],
    ["descanso"]
  ];

  // Funci칩n para filtrar comidas seg칰n alergias y dislikes
  function filtrarComidas(lista, alergias, dislikes) {
    return lista.filter(c => {
      // Si alg칰n ingrediente est치 en alergias o dislikes, se elimina
      for (const ing of c.ingredientes) {
        if (alergias.includes(ing.trim().toLowerCase()) || dislikes.includes(ing.trim().toLowerCase())) {
          return false;
        }
      }
      return true;
    });
  }

  // Funci칩n para generar un plan de comidas y rutina para 30 d칤as
  function generarPlan(datos) {
    const { age, weight, height, sex, goal, budget, sport, allergies, dislikes } = datos;

    // Convertir a arrays limpios
    const alergiasArr = allergies.split(',').map(s => s.trim().toLowerCase()).filter(s => s);
    const dislikesArr = dislikes.split(',').map(s => s.trim().toLowerCase()).filter(s => s);

    // Filtrar comidas
    const desayunosFiltrados = filtrarComidas(desayunos, alergiasArr, dislikesArr);
    const comidasFiltradas = filtrarComidas(comidas, alergiasArr, dislikesArr);
    const cenasFiltradas = filtrarComidas(cenas, alergiasArr, dislikesArr);
    const snacksFiltrados = filtrarComidas(snacks, alergiasArr, dislikesArr);

    if(desayunosFiltrados.length === 0 || comidasFiltradas.length === 0 || cenasFiltradas.length === 0 || snacksFiltrados.length === 0) {
      return { error: "No hay suficientes comidas disponibles con tus alergias y preferencias." };
    }

    // N칰mero de comidas al d칤a seg칰n objetivo
    let comidasPorDia = 3;
    if(goal === "gainMuscle") comidasPorDia = 4;

    // Calcular presupuesto por comida (simplificado)
    const presupuestoPorComida = budget / 30 / comidasPorDia;

    // Crear plan para 30 d칤as
    let plan = [];
    for(let d=1; d<=30; d++) {
      let diaPlan = { dia: d };

      // Elegir desayuno, comida, cena y snack aleatorios y dentro del presupuesto
      diaPlan.desayuno = desayunosFiltrados.find(c => c.precio <= presupuestoPorComida) || desayunosFiltrados[0];
      diaPlan.comida = comidasFiltradas.find(c => c.precio <= presupuestoPorComida) || comidasFiltradas[0];
      diaPlan.cena = cenasFiltradas.find(c => c.precio <= presupuestoPorComida) || cenasFiltradas[0];
      if(comidasPorDia === 4) {
        diaPlan.snack = snacksFiltrados.find(c => c.precio <= presupuestoPorComida) || snacksFiltrados[0];
      } else {
        diaPlan.snack = null;
      }

      // Rutina
      const diaRutinaIndex = (d-1) % rutinaPorDia.length;
      const gruposMusculares = rutinaPorDia[diaRutinaIndex];
      if(gruposMusculares[0] === "descanso") {
        diaPlan.rutina = [{ nombre: "Descanso", repeticiones: "-", descanso: "-" }];
      } else {
        diaPlan.rutina = [];
        gruposMusculares.forEach(grupo => {
          const ejerciciosGrupo = ejerciciosPorGrupo[grupo];
          // Tomar primeros 2 ejercicios del grupo para el ejemplo
          diaPlan.rutina.push(...ejerciciosGrupo.slice(0,2));
        });
      }

      plan.push(diaPlan);
    }
    return { plan };
  }

  // Capturar evento submit del form para generar plan
  document.getElementById('plan-form').addEventListener('submit', (e) => {
    e.preventDefault();
    const datos = {
      age: Number(document.getElementById('age').value),
      weight: Number(document.getElementById('weight').value),
      height: Number(document.getElementById('height').value),
      sex: document.getElementById('sex').value,
      goal: document.getElementById('goal').value,
      budget: Number(document.getElementById('budget').value),
      sport: document.getElementById('sport').value,
      allergies: document.getElementById('allergies').value,
      dislikes: document.getElementById('dislikes').value,
    };
    const resultado = generarPlan(datos);
    if(resultado.error) {
      document.getElementById('output').innerHTML = `<p style="color:#ff5555;">${resultado.error}</p>`;
    } else {
      mostrarPlanCompleto(resultado.plan);
    }
  });

  // Funci칩n para mostrar el plan completo de 30 d칤as con tabla y rutina
  function mostrarPlanCompleto(plan) {
    let html = `<h3>Plan personalizado para 30 d칤as</h3>`;
    html += `<table border="1" cellpadding="8" cellspacing="0" style="width:100%;color:#aaffcc;border-collapse:collapse; font-size:0.9rem;">
      <thead>
        <tr style="background:#003300;">
          <th>D칤a</th><th>Desayuno</th><th>Comida</th><th>Cena</th><th>Snack</th>
        </tr>
      </thead><tbody>`;
    plan.forEach(d => {
      html += `<tr>
        <td>${d.dia}</td>
        <td>${d.desayuno ? `${d.desayuno.nombre} (${d.desayuno.gramos}g)` : '-'}</td>
        <td>${d.comida ? `${d.comida.nombre} (${d.comida.gramos}g)` : '-'}</td>
        <td>${d.cena ? `${d.cena.nombre} (${d.cena.gramos}g)` : '-'}</td>
        <td>${d.snack ? `${d.snack.nombre} (${d.snack.gramos}g)` : '-'}</td>
      </tr>`;
    });
    html += `</tbody></table><br>`;

    html += `<h3>Rutina de ejercicios</h3>`;
    plan.forEach(d => {
      html += `<strong>D칤a ${d.dia}:</strong> <ul style="margin-bottom:15px;">`;
      d.rutina.forEach(ej => {
        html += `<li>${ej.nombre} - ${ej.repeticiones} repeticiones - Descanso: ${ej.descanso}</li>`;
      });
      html += `</ul>`;
    });

    document.getElementById('output').innerHTML = html;
  }
</script>
<!-- PARTE 3: FILTROS AVANZADOS Y AMPLIACI칍N DE BASE DE DATOS -->

<style>
  /* Estilos para mostrar filtros y tabla */
  #filters {
    background: rgba(255 255 255 / 0.8);
    padding: 1rem;
    border-radius: 12px;
    margin-bottom: 20px;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }
  label {
    font-weight: 600;
  }
  select, input[type="text"], input[type="number"] {
    margin: 0.5rem 0 1rem 0;
    padding: 6px 8px;
    border-radius: 6px;
    border: 1px solid #ddd;
    width: 100%;
  }
</style>

<div id="filters">
  <h2>Personaliza tu NutriJosue</h2>
  
  <label for="allergiesInput">Alergias (separa con comas):</label>
  <input type="text" id="allergiesInput" placeholder="Ejemplo: man칤, mariscos" />
  
  <label for="dislikesInput">Comidas que no te gustan (separa con comas):</label>
  <input type="text" id="dislikesInput" placeholder="Ejemplo: br칩coli, pescado" />
  
  <label for="budgetInput">Presupuesto mensual m치ximo (MXN):</label>
  <input type="number" id="budgetInput" min="500" max="20000" step="100" value="4000" />
  
  <button id="applyFiltersBtn" style="background:#1b5e20;color:#fff;padding:10px 15px;border:none;border-radius:8px;cursor:pointer;">
    Aplicar filtros y generar plan
  </button>
</div>

<script>
  // Base ampliada de comidas (solo muestras, deber치s a침adir 150+ cada categor칤a)
  const foods = {
    desayunos: [
      { nombre: "Avena con frutas", calorias: 350, precio: 20, alergias: [], tags: ["normal", "bajo_grasa"] },
      { nombre: "Huevos revueltos con espinacas", calorias: 300, precio: 25, alergias: ["huevo"], tags: ["alto_proteina"] },
      { nombre: "Pan integral con aguacate", calorias: 400, precio: 30, alergias: ["gluten"], tags: ["normal"] },
      // Agrega m치s desayunos aqu칤
    ],
    comidas: [
      { nombre: "Pechuga de pollo con arroz integral", calorias: 600, precio: 50, alergias: [], tags: ["alto_proteina"] },
      { nombre: "Ensalada de quinoa con verduras", calorias: 450, precio: 40, alergias: [], tags: ["vegetariano", "bajo_grasa"] },
      { nombre: "Salm칩n a la plancha con br칩coli", calorias: 650, precio: 70, alergias: ["pescado"], tags: ["alto_proteina"] },
      // Agrega m치s comidas aqu칤
    ],
    cenas: [
      { nombre: "Tortilla de claras con espinaca", calorias: 300, precio: 20, alergias: ["huevo"], tags: ["bajo_grasa"] },
      { nombre: "Sopa de verduras con pollo", calorias: 350, precio: 25, alergias: [], tags: ["normal"] },
      { nombre: "Ensalada C칠sar sin crutones", calorias: 400, precio: 35, alergias: ["lactosa"], tags: ["normal"] },
      // Agrega m치s cenas aqu칤
    ],
    snacks: [
      { nombre: "Nueces mixtas (30g)", calorias: 200, precio: 15, alergias: ["nueces"], tags: ["alto_grasa"] },
      { nombre: "Yogur natural", calorias: 150, precio: 20, alergias: ["lactosa"], tags: ["normal"] },
      { nombre: "Fruta fresca (manzana)", calorias: 100, precio: 10, alergias: [], tags: ["normal"] },
      // Agrega m치s snacks aqu칤
    ]
  };

  // Funci칩n para filtrar alimentos seg칰n alergias y dislikes
  function filterFoods(allergiesArr, dislikesArr) {
    const filtered = {};
    for (const mealType in foods) {
      filtered[mealType] = foods[mealType].filter(food => {
        // No incluir si alguna alergia coincide
        if (food.alergias.some(a => allergiesArr.includes(a.toLowerCase().trim()))) return false;
        // No incluir si nombre est치 en dislikes
        if (dislikesArr.some(d => food.nombre.toLowerCase().includes(d.toLowerCase().trim()))) return false;
        return true;
      });
    }
    return filtered;
  }

  // Funci칩n para generar plan mensual ajustado al presupuesto
  function generatePlan(filteredFoods, budget) {
    const dailyCaloriesGoal = 2000; // base, luego puedes ajustar seg칰n usuario
    const days = 30;
    const mealsPerDay = {
      desayuno: 1,
      comida: 1,
      cena: 1,
      snack: 1
    };
    
    // Estimaci칩n presupuesto diario y selecci칩n comidas
    const budgetPerDay = budget / days;
    
    // Aqu칤 armar치s el plan d칤a a d칤a
    let plan = [];
    for (let d = 1; d <= days; d++) {
      let dayPlan = {
        desayuno: pickMeal(filteredFoods.desayunos, budgetPerDay * 0.25),
        comida: pickMeal(filteredFoods.comidas, budgetPerDay * 0.35),
        cena: pickMeal(filteredFoods.cenas, budgetPerDay * 0.25),
        snack: pickMeal(filteredFoods.snacks, budgetPerDay * 0.15),
      };
      plan.push(dayPlan);
    }
    return plan;
  }

  // Funci칩n para seleccionar comida seg칰n presupuesto m치ximo para esa comida
  function pickMeal(mealArray, maxPrice) {
    // Filtrar comidas dentro del presupuesto
    const options = mealArray.filter(m => m.precio <= maxPrice);
    if (options.length === 0) return { nombre: "Sin opci칩n disponible", calorias: 0, precio: 0 };
    // Elegir aleatoriamente una opci칩n disponible
    return options[Math.floor(Math.random() * options.length)];
  }

  // Mostrar plan en consola para pruebas (despu칠s agregar tabla en UI)
  document.getElementById("applyFiltersBtn").addEventListener("click", () => {
    const allergies = document.getElementById("allergiesInput").value.toLowerCase().split(",").map(s => s.trim()).filter(Boolean);
    const dislikes = document.getElementById("dislikesInput").value.toLowerCase().split(",").map(s => s.trim()).filter(Boolean);
    const budget = Number(document.getElementById("budgetInput").value);
    
    const filtered = filterFoods(allergies, dislikes);
    const plan = generatePlan(filtered, budget);
    
    console.clear();
    console.log("Plan mensual NutriJosue filtrado:");
    console.log(plan);
    alert("Plan generado! Revisa la consola para ver la estructura (m치s adelante mostramos en tabla en UI)");
  });
</script>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #2b5d34, #1b3a1a);
    color: #e0f2f1;
    margin: 0; padding: 0;
  }

  header {
    text-align: center;
    padding: 1rem 0;
    background: rgba(0,0,0,0.3);
    font-weight: 700;
    font-size: 2.2rem;
    letter-spacing: 2px;
    border-bottom: 2px solid #2ecc71;
  }

  header span {
    color: #81c784;
  }

  #phrase {
    font-size: 1rem;
    font-style: italic;
    margin-bottom: 1.2rem;
    color: #a5d6a7;
  }

  #planContainer {
    max-width: 1000px;
    margin: 0 auto 3rem;
    overflow-x: auto;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: rgba(0,0,0,0.25);
    border-radius: 12px;
    box-shadow: 0 0 20px #1b5e20cc;
  }

  th, td {
    border: 1px solid #2e7d32;
    padding: 0.75rem;
    text-align: center;
    vertical-align: middle;
  }

  th {
    background: #2e7d32;
    font-weight: 700;
  }

  td {
    background: rgba(33, 87, 38, 0.8);
    font-size: 0.9rem;
  }

  .btn-explosion {
    background: #388e3c;
    border: none;
    color: #e0f2f1;
    padding: 0.4rem 0.8rem;
    margin: 0.3rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 700;
    box-shadow: 0 0 8px #81c784;
    transition: transform 0.2s ease;
  }
  .btn-explosion:active {
    transform: scale(1.1);
  }

  /* Explosi칩n animaci칩n peque침a */
  .explosion {
    position: absolute;
    pointer-events: none;
    border-radius: 50%;
    background: radial-gradient(circle, #a5d6a7 40%, transparent 70%);
    animation: explode 0.4s forwards;
    z-index: 9999;
  }
  @keyframes explode {
    0% {
      opacity: 1;
      transform: scale(0.2);
    }
    100% {
      opacity: 0;
      transform: scale(2);
    }
  }
</style>

<header>
  Nutri<span>JB</span>
  <div id="phrase">Your life Your way Your Diet</div>
</header>

<div id="planContainer">
  <table id="planTable" aria-label="Plan Nutricional y Rutina de 30 d칤as">
    <thead>
      <tr>
        <th>D칤a</th>
        <th>Desayuno (g)</th>
        <th>Comida (g)</th>
        <th>Cena (g)</th>
        <th>Snack (g)</th>
        <th>Rutina (Reps / Descanso)</th>
      </tr>
    </thead>
    <tbody>
      <!-- Aqu칤 se va a generar el plan -->
    </tbody>
  </table>
</div>

<div style="text-align:center; margin-bottom:3rem;">
  <button id="changeMealsBtn" class="btn-explosion">Cambiar Comidas</button>
  <button id="changeRoutineBtn" class="btn-explosion">Cambiar Rutina</button>
</div>

<script>
  // Simulaci칩n de plan base para 30 d칤as - se deber칤a pasar desde la Parte 3
  // Para ejemplo usamos comidas random y rutina random, luego conectar con parte 3

  // Datos base comidas (nombre + gramos)
  const samplePlan = [];
  const mealsGrams = {
    desayuno: 250,
    comida: 350,
    cena: 300,
    snack: 150
  };

  // Rutinas por grupos musculares con repeticiones y descanso (segundos)
  const routinesByDay = [
    { grupo: "Pecho y Tr칤ceps", ejercicios: 4, reps: "12-15", descanso: 60 },
    { grupo: "Piernas y Abdomen", ejercicios: 5, reps: "15-20", descanso: 60 },
    { grupo: "Espalda, Hombros y Cuello", ejercicios: 4, reps: "12-15", descanso: 75 },
    { grupo: "Cardio y Estiramiento", ejercicios: 3, reps: "20-25", descanso: 45 }
  ];

  // Funci칩n para generar plan simulado (reemplazar con plan real)
  function generateSamplePlan() {
    samplePlan.length = 0;
    for(let day=1; day<=30; day++){
      // Selecci칩n random de comida para demo
      const desayuno = `Desayuno ejemplo ${day}`;
      const comida = `Comida ejemplo ${day}`;
      const cena = `Cena ejemplo ${day}`;
      const snack = `Snack ejemplo ${day}`;
      // Rutina rotativa entre grupos
      const rutina = routinesByDay[(day-1) % routinesByDay.length];

      samplePlan.push({
        desayuno: { nombre: desayuno, gramos: mealsGrams.desayuno },
        comida: { nombre: comida, gramos: mealsGrams.comida },
        cena: { nombre: cena, gramos: mealsGrams.cena },
        snack: { nombre: snack, gramos: mealsGrams.snack },
        rutina: `${rutina.grupo} - ${rutina.ejercicios} ejercicios, ${rutina.reps} reps, ${rutina.descanso}s descanso`
      });
    }
  }

  // Mostrar plan en tabla
  function renderPlan() {
    const tbody = document.querySelector("#planTable tbody");
    tbody.innerHTML = ""; // limpia tabla

    samplePlan.forEach((dayPlan, index) => {
      const tr = document.createElement("tr");

      // D칤a
      const tdDay = document.createElement("td");
      tdDay.textContent = index + 1;
      tr.appendChild(tdDay);

      // Desayuno
      const tdDesayuno = document.createElement("td");
      tdDesayuno.textContent = `${dayPlan.desayuno.nombre} (${dayPlan.desayuno.gramos}g)`;
      tr.appendChild(tdDesayuno);

      // Comida
      const tdComida = document.createElement("td");
      tdComida.textContent = `${dayPlan.comida.nombre} (${dayPlan.comida.gramos}g)`;
      tr.appendChild(tdComida);

      // Cena
      const tdCena = document.createElement("td");
      tdCena.textContent = `${dayPlan.cena.nombre} (${dayPlan.cena.gramos}g)`;
      tr.appendChild(tdCena);

      // Snack
      const tdSnack = document.createElement("td");
      tdSnack.textContent = `${dayPlan.snack.nombre} (${dayPlan.snack.gramos}g)`;
      tr.appendChild(tdSnack);

      // Rutina
      const tdRutina = document.createElement("td");
      tdRutina.textContent = dayPlan.rutina;
      tr.appendChild(tdRutina);

      tbody.appendChild(tr);
    });
  }

  // Animaci칩n explosi칩n peque침a
  function smallExplosion(x, y) {
    const explosion = document.createElement("div");
    explosion.classList.add("explosion");
    explosion.style.left = `${x - 15}px`;
    explosion.style.top = `${y - 15}px`;
    document.body.appendChild(explosion);
    explosion.addEventListener("animationend", () => explosion.remove());
  }

  // Cambiar comidas: genera nuevo plan comidas y refresca tabla
  document.getElementById("changeMealsBtn").addEventListener("click", (e) => {
    e.preventDefault();
    smallExplosion(e.clientX, e.clientY);

    // Aqu칤 se podr칤a llamar a una funci칩n que genera plan comida nueva
    // Por ahora solo regeneramos el plan simulado
    generateSamplePlan();
    renderPlan();
  });

  // Cambiar rutina: cambia rutina rotativa para demo y refresca tabla
  document.getElementById("changeRoutineBtn").addEventListener("click", (e) => {
    e.preventDefault();
    smallExplosion(e.clientX, e.clientY);

    // Cambiamos rutinas: simplemente cambiamos el orden para simular cambio
    routinesByDay.push(routinesByDay.shift());
    generateSamplePlan();
    renderPlan();
  });

  // Al cargar la p치gina
  generateSamplePlan();
  renderPlan();
</script>
<!-- Librer칤a jsPDF CDN para exportar PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<div style="text-align:center; margin-bottom: 3rem;">
  <button id="savePlanBtn" class="btn-explosion" title="Guardar plan">游 Guardar Plan</button>
  <button id="loadPlanBtn" class="btn-explosion" title="Cargar plan guardado">游늭 Cargar Plan</button>
  <button id="exportPdfBtn" class="btn-explosion" title="Exportar plan a PDF">游늯 Exportar PDF</button>
</div>

<script>
  // Guardar plan en localStorage
  document.getElementById("savePlanBtn").addEventListener("click", (e) => {
    e.preventDefault();
    smallExplosion(e.clientX, e.clientY);

    try {
      localStorage.setItem("nutriJosuePlan", JSON.stringify(samplePlan));
      alert("Plan guardado exitosamente!");
    } catch (err) {
      alert("Error guardando plan: " + err.message);
    }
  });

  // Cargar plan de localStorage
  document.getElementById("loadPlanBtn").addEventListener("click", (e) => {
    e.preventDefault();
    smallExplosion(e.clientX, e.clientY);

    try {
      const storedPlan = localStorage.getItem("nutriJosuePlan");
      if (storedPlan) {
        const planData = JSON.parse(storedPlan);
        if (Array.isArray(planData)) {
          samplePlan.length = 0;
          samplePlan.push(...planData);
          renderPlan();
          alert("Plan cargado correctamente!");
        } else {
          alert("El plan guardado no es v치lido.");
        }
      } else {
        alert("No hay plan guardado.");
      }
    } catch (err) {
      alert("Error cargando plan: " + err.message);
    }
  });

  // Exportar tabla a PDF con jsPDF
  document.getElementById("exportPdfBtn").addEventListener("click", async (e) => {
    e.preventDefault();
    smallExplosion(e.clientX, e.clientY);

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF('l', 'pt', 'a4');
    const margin = 20;
    const startY = 50;

    doc.setFontSize(18);
    doc.setTextColor("#2e7d32");
    doc.text("NutriJB - Plan Mensual Nutricional y Rutina", margin, 30);
    doc.setFontSize(12);
    doc.setTextColor("#1b3a1a");
    doc.text("Your life Your way Your Diet", margin, 45);

    // Preparamos la data para PDF
    const columns = [
      "D칤a",
      "Desayuno (g)",
      "Comida (g)",
      "Cena (g)",
      "Snack (g)",
      "Rutina (Reps / Descanso)"
    ];

    const rows = samplePlan.map((dayPlan, index) => [
      index + 1,
      `${dayPlan.desayuno.nombre} (${dayPlan.desayuno.gramos}g)`,
      `${dayPlan.comida.nombre} (${dayPlan.comida.gramos}g)`,
      `${dayPlan.cena.nombre} (${dayPlan.cena.gramos}g)`,
      `${dayPlan.snack.nombre} (${dayPlan.snack.gramos}g)`,
      dayPlan.rutina
    ]);

    // Usamos autoTable para tabla
    // Si quieres, puedes a침adir el plugin jsPDF autotable, pero para simple, hacemos una tabla manual:
    let y = startY;
    const lineHeight = 18;
    const pageHeight = doc.internal.pageSize.height;

    // Escribir encabezados
    columns.forEach((col, i) => {
      doc.text(col, margin + i*90, y);
    });
    y += lineHeight;

    // Escribir filas (si es mucha info, puede ser lento)
    for (let i=0; i<rows.length; i++) {
      const row = rows[i];
      row.forEach((cell, j) => {
        const text = cell.length > 30 ? cell.substring(0, 27) + "..." : cell;
        doc.text(text, margin + j*90, y);
      });
      y += lineHeight;
      if (y > pageHeight - 40) {
        doc.addPage();
        y = startY;
      }
    }

    doc.save("NutriJB_Plan_Mensual.pdf");
  });
</script>
<script>
// LISTADO SIMPLIFICADO DE ALIMENTOS - solo ejemplos, pero en real agrega 150+ como pediste

const alimentos = {
  desayunos: [
    {nombre: "Avena con frutas", alergias:["gluten"], calorias:350, precio:20, gramos:150},
    {nombre: "Huevos revueltos", alergias:["huevo"], calorias:300, precio:25, gramos:120},
    {nombre: "Yogur natural con nueces", alergias:["lacteos","nuez"], calorias:250, precio:30, gramos:130},
    // Agrega m치s...
  ],
  comidas: [
    {nombre: "Pechuga de pollo a la plancha", alergias:[], calorias:400, precio:50, gramos:180},
    {nombre: "Ensalada de at칰n", alergias:["pescado"], calorias:350, precio:45, gramos:170},
    {nombre: "Tofu salteado con verduras", alergias:["soja"], calorias:300, precio:40, gramos:160},
    // Agrega m치s...
  ],
  cenas: [
    {nombre: "Sopa de verduras", alergias:[], calorias:200, precio:35, gramos:140},
    {nombre: "Filete de salm칩n", alergias:["pescado"], calorias:450, precio:60, gramos:150},
    {nombre: "Ensalada C칠sar", alergias:["lacteos","gluten"], calorias:300, precio:40, gramos:130},
    // Agrega m치s...
  ],
  snacks: [
    {nombre: "Almendras", alergias:["nuez"], calorias:150, precio:15, gramos:50},
    {nombre: "Fruta fresca", alergias:[], calorias:100, precio:10, gramos:80},
    {nombre: "Barra de prote칤na", alergias:["soja","lacteos"], calorias:200, precio:25, gramos:60},
    // Agrega m치s...
  ]
};

// Funci칩n para filtrar alimentos seg칰n alergias, gustos y enfermedades
function filtrarAlimentos(lista, alergiasUsuario, noGusta) {
  return lista.filter(item => {
    // Si tiene alguna alergia del usuario
    for (const alergia of alergiasUsuario) {
      if (item.alergias.includes(alergia.toLowerCase())) return false;
    }
    // Si el alimento est치 en la lista de que no gusta
    if (noGusta.some(ng => ng.toLowerCase() === item.nombre.toLowerCase())) return false;
    return true;
  });
}

// Ajustar porciones segun objetivo (bajar grasa = 3 comidas, subir musculo = 4 comidas)
function ajustarPorciones(gramos, objetivo) {
  if (objetivo === "bajar grasa") {
    return gramos * 0.8; // reducir un poco por ejemplo
  } else if (objetivo === "subir musculo") {
    return gramos * 1.2; // aumentar porciones
  }
  return gramos;
}

// Generar plan diario con presupuesto y filtros
function generarPlanMes(altura, peso, edad, sexo, objetivo, presupuestoMensual, alergiasUsuario, noGusta) {
  const dias = 30;
  const planMes = [];

  // Calculo presupuesto diario ajustado para comidas
  // Asumiendo 3 comidas + snack si subir m칰sculo
  const comidasDiarias = objetivo === "subir musculo" ? 4 : 3;
  const presupuestoDiario = presupuestoMensual / 30;

  // Filtrar listas seg칰n alergias y gustos
  const desayunosFiltrados = filtrarAlimentos(alimentos.desayunos, alergiasUsuario, noGusta);
  const comidasFiltradas = filtrarAlimentos(alimentos.comidas, alergiasUsuario, noGusta);
  const cenasFiltradas = filtrarAlimentos(alimentos.cenas, alergiasUsuario, noGusta);
  const snacksFiltrados = filtrarAlimentos(alimentos.snacks, alergiasUsuario, noGusta);

  for (let i=0; i<dias; i++) {
    // Elegir aleatoriamente comidas dentro del presupuesto
    let desayuno = elegirComidaPresupuesto(desayunosFiltrados, presupuestoDiario * 0.25);
    let comida = elegirComidaPresupuesto(comidasFiltradas, presupuestoDiario * 0.4);
    let cena = elegirComidaPresupuesto(cenasFiltradas, presupuestoDiario * 0.25);
    let snack = (objetivo === "subir musculo") ? elegirComidaPresupuesto(snacksFiltrados, presupuestoDiario * 0.1) : {nombre:"-", gramos:0};

    // Ajustar porciones seg칰n objetivo
    desayuno.gramos = Math.round(ajustarPorciones(desayuno.gramos, objetivo));
    comida.gramos = Math.round(ajustarPorciones(comida.gramos, objetivo));
    cena.gramos = Math.round(ajustarPorciones(cena.gramos, objetivo));
    if (snack.nombre !== "-") snack.gramos = Math.round(ajustarPorciones(snack.gramos, objetivo));

    // Generar rutina seg칰n d칤a y dificultad (puedes usar la rutina base que tienes)
    const rutina = generarRutinaDia(i, dificultadActual);

    planMes.push({
      desayuno,
      comida,
      cena,
      snack,
      rutina
    });
  }

  return planMes;
}

// Elegir comida que no pase el presupuesto asignado (simplemente el primero que calce, o el menos caro)
function elegirComidaPresupuesto(lista, presupuesto) {
  const opciones = lista.filter(item => item.precio <= presupuesto);
  if (opciones.length === 0) {
    // Si no hay opci칩n, devolver la comida menos cara
    return lista.reduce((min, item) => item.precio < min.precio ? item : min, lista[0]);
  }
  // Elegir aleatoriamente entre opciones dentro del presupuesto
  return opciones[Math.floor(Math.random()*opciones.length)];
}

// Rutina base simplificada para ejemplo, ajusta segun dificultadActual
function generarRutinaDia(dia, dificultad) {
  // Ejemplo: 3 grupos musculares alternados, reps y descanso seg칰n dificultad
  const grupos = [
    "Pecho y Tr칤ceps",
    "Piernas y Abdomen",
    "Espalda y Hombro",
    "Descanso Activo"
  ];

  const grupo = grupos[dia % grupos.length];

  // Reps y descanso var칤an con dificultad (1 a 4)
  const repsBase = [12, 15, 18, 20];
  const descansoBase = [60, 45, 30, 20]; // segundos

  return `${grupo} - ${repsBase[dificultad-1]} reps - ${descansoBase[dificultad-1]} seg descanso`;
}

// Variables globales para demo
let dificultadActual = 1;
let alturaDemo = 170;
let pesoDemo = 70;
let edadDemo = 25;
let sexoDemo = "masculino";
let objetivoDemo = "bajar grasa";
let presupuestoDemo = 3000; // pesos mensuales
let alergiasDemo = ["huevo", "lacteos"];
let noGustaDemo = ["Ensalada C칠sar"];

// Al generar o cambiar opciones, llama a:
const samplePlan = generarPlanMes(alturaDemo, pesoDemo, edadDemo, sexoDemo, objetivoDemo, presupuestoDemo, alergiasDemo, noGustaDemo);

renderPlan();

</script>
<style>
  /* Fuente moderna y limpia */
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
  }

  header {
    background: rgba(0,0,0,0.6);
    padding: 20px;
    text-align: center;
    font-weight: 600;
    font-size: 2.5rem;
    letter-spacing: 2px;
    user-select: none;
  }

  header small {
    display: block;
    font-weight: 400;
    font-size: 1rem;
    margin-top: 5px;
    font-style: italic;
    color: #ffd700;
  }

  main {
    max-width: 1200px;
    margin: 20px auto;
    background: rgba(0,0,0,0.5);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 0 15px 3px #00ffcc;
  }

  button {
    cursor: pointer;
    background: linear-gradient(45deg, #00ffcc, #006666);
    border: none;
    border-radius: 10px;
    color: #000;
    font-weight: 600;
    padding: 15px 30px;
    margin: 10px;
    transition: transform 0.15s ease-in-out, box-shadow 0.3s ease;
    box-shadow: 0 5px 15px rgba(0,255,204,0.7);
    user-select: none;
  }
  button:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 25px rgba(0,255,204,0.9);
  }

  /* Contenedor de la tabla para scroll horizontal */
  .tabla-container {
    overflow-x: auto;
    max-height: 500px;
    margin-top: 20px;
  }

  table {
    border-collapse: collapse;
    width: 100%;
    color: #00ffcc;
  }

  th, td {
    border: 1px solid #00ffcc;
    padding: 10px;
    text-align: center;
    font-size: 0.85rem;
  }

  th {
    background: #003333;
  }

  /* Animacion explosion chiquita */
  .explode {
    position: absolute;
    border-radius: 50%;
    pointer-events: none;
    animation: explodeAnim 0.6s forwards;
    background: radial-gradient(circle, #00ffcc 0%, transparent 80%);
    width: 50px;
    height: 50px;
    opacity: 0.8;
    z-index: 9999;
  }

  @keyframes explodeAnim {
    0% {
      transform: scale(0.3);
      opacity: 0.8;
    }
    100% {
      transform: scale(2);
      opacity: 0;
    }
  }

  footer {
    text-align: center;
    margin: 25px;
    font-size: 0.9rem;
    font-style: italic;
    color: #00ffcc;
    user-select: none;
  }
</style>

<header>
  NutriJB
  <small>Your life Your way Your Diet</small>
</header>

<main>
  <div>
    <button id="btnCambiarComidas">Cambiar Comidas</button>
    <button id="btnCambiarRutina">Cambiar Rutina</button>
    <button id="btnAumentarDificultad">Subir Dificultad Ejercicios</button>
    <button id="btnDisminuirDificultad">Bajar Dificultad Ejercicios</button>
    <button id="btnCambiarMes">Cambiar Mes (1-12)</button>
  </div>

  <div class="tabla-container">
    <table id="tablaPlan">
      <!-- Aqu칤 se carga la tabla generada -->
    </table>
  </div>
</main>

<footer>
  NIGEERRRR
</footer>

<script>
  // Funci칩n para crear animaci칩n de explosi칩n chiquita en el bot칩n clickeado
  function explosionEffect(event) {
    const btn = event.currentTarget;
    const rect = btn.getBoundingClientRect();

    const explosion = document.createElement('div');
    explosion.classList.add('explode');

    // Posici칩n: centro del bot칩n
    explosion.style.left = (event.clientX - rect.left - 25) + 'px';
    explosion.style.top = (event.clientY - rect.top - 25) + 'px';

    btn.appendChild(explosion);

    setTimeout(() => {
      explosion.remove();
    }, 600);
  }

  // Variables globales para demo, puedes conectar a inputs reales luego
  let dificultadActual = 1; // 1 a 4
  let mesActual = 1;
  let alturaDemo = 170;
  let pesoDemo = 70;
  let edadDemo = 25;
  let sexoDemo = "masculino";
  let objetivoDemo = "bajar grasa"; // o "subir musculo"
  let presupuestoDemo = 3000; // pesos mensuales
  let alergiasDemo = ["huevo", "lacteos"];
  let noGustaDemo = ["Ensalada C칠sar"];

  // Ya tienes la funci칩n generarPlanMes en la parte 6
  // Aqu칤 la usamos para generar y renderizar la tabla para un mes dado

  function renderPlan(mes = 1) {
    // Para demo: solo generamos 30 d칤as del mes
    const plan = generarPlanMes(alturaDemo, pesoDemo, edadDemo, sexoDemo, objetivoDemo, presupuestoDemo, alergiasDemo, noGustaDemo);
    const tabla = document.getElementById('tablaPlan');

    // Crear encabezados
    let html = `<thead><tr>
      <th>D칤a</th>
      <th>Desayuno (g)</th>
      <th>Comida (g)</th>
      <th>Cena (g)</th>
      <th>Snack (g)</th>
      <th>Rutina y Ejercicios</th>
    </tr></thead><tbody>`;

    plan.forEach((diaPlan, i) => {
      html += `<tr>
        <td>${i + 1}</td>
        <td>${diaPlan.desayuno.nombre} (${diaPlan.desayuno.gramos}g)</td>
        <td>${diaPlan.comida.nombre} (${diaPlan.comida.gramos}g)</td>
        <td>${diaPlan.cena.nombre} (${diaPlan.cena.gramos}g)</td>
        <td>${diaPlan.snack.nombre} ${diaPlan.snack.gramos ? `(${diaPlan.snack.gramos}g)` : ''}</td>
        <td>${diaPlan.rutina}</td>
      </tr>`;
    });
    html += '</tbody>';

    tabla.innerHTML = html;
  }

  // Botones y eventos
  document.getElementById('btnCambiarComidas').addEventListener('click', e => {
    explosionEffect(e);
    // Cambiar comidas aleatoriamente (cambia lista de noGusta para simular cambio)
    noGustaDemo = noGustaDemo.length === 0 ? ["Almendras"] : [];
    renderPlan(mesActual);
  });

  document.getElementById('btnCambiarRutina').addEventListener('click', e => {
    explosionEffect(e);
    // Cambia rutina: para demo solo cambia dificultad para variar rutina
    dificultadActual = dificultadActual === 4 ? 1 : dificultadActual + 1;
    renderPlan(mesActual);
  });

  document.getElementById('btnAumentarDificultad').addEventListener('click', e => {
    explosionEffect(e);
    if(dificultadActual < 4) dificultadActual++;
    renderPlan(mesActual);
  });

  document.getElementById('btnDisminuirDificultad').addEventListener('click', e => {
    explosionEffect(e);
    if(dificultadActual > 1) dificultadActual--;
    renderPlan(mesActual);
  });

  document.getElementById('btnCambiarMes').addEventListener('click', e => {
    explosionEffect(e);
    mesActual++;
    if(mesActual > 12) mesActual = 1;
    // En tu sistema podr칤as generar planes diferentes para cada mes si quieres
    renderPlan(mesActual);
  });

  // Render inicial
  renderPlan(mesActual);

</script>
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NutriJB - Your life Your way Your Diet</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
  body {
    margin: 0; padding: 0;
    font-family: 'Montserrat', sans-serif;
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  header {
    background: rgba(0, 80, 50, 0.85);
    padding: 1rem;
    text-align: center;
    font-size: 2.5rem;
    font-weight: 700;
    letter-spacing: 3px;
    user-select: none;
    text-shadow: 1px 1px 3px #000;
  }
  footer {
    background: rgba(0, 80, 50, 0.85);
    padding: 0.5rem;
    text-align: center;
    font-style: italic;
    font-weight: 600;
    user-select: none;
    text-shadow: 1px 1px 2px #000;
  }
  main {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    background: rgba(0, 0, 0, 0.4);
  }
  .controls {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }
  button {
    background: #0a4d22;
    border: none;
    padding: 0.8rem 1.2rem;
    color: #fff;
    font-weight: 700;
    font-size: 1rem;
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    position: relative;
    overflow: hidden;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #146636;
  }
  /* Small explosion animation */
  button:active .explosion {
    animation: explode 0.5s ease forwards;
  }
  @keyframes explode {
    0% {
      opacity: 1;
      transform: scale(1);
    }
    100% {
      opacity: 0;
      transform: scale(2);
    }
  }
  .explosion {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    background: radial-gradient(circle, #a6ff00 0%, transparent 70%);
    border-radius: 50%;
    pointer-events: none;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
    z-index: 10;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    color: #ddd;
  }
  th, td {
    border: 1px solid #2e7d32;
    padding: 0.5rem;
    text-align: center;
    font-size: 0.85rem;
  }
  th {
    background: #146636;
    position: sticky;
    top: 0;
    z-index: 5;
  }
  tr:nth-child(even) {
    background: rgba(0, 77, 30, 0.4);
  }
  tr:hover {
    background: rgba(102, 187, 106, 0.7);
    color: #000;
  }
  /* Scroll bar */
  main::-webkit-scrollbar {
    width: 10px;
  }
  main::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
  }
  main::-webkit-scrollbar-thumb {
    background-color: #0a4d22;
    border-radius: 20px;
  }
  /* Responsive */
  @media (max-width: 768px) {
    th, td {
      font-size: 0.7rem;
      padding: 0.3rem;
    }
    header {
      font-size: 1.8rem;
    }
  }
</style>
</head>
<body>

<header>NutriJB</header>

<main>
  <div class="controls">
    <button id="btnChangeMeals">Cambiar Comidas<span class="explosion"></span></button>
    <button id="btnChangeRoutine">Cambiar Rutina<span class="explosion"></span></button>
    <button id="btnIncreaseDifficulty">Subir Nivel de Dificultad<span class="explosion"></span></button>
    <button id="btnIncreaseMonth">Subir Mes (1-12)<span class="explosion"></span></button>
  </div>

  <table id="planTable">
    <thead>
      <tr>
        <th>D칤a</th>
        <th>Desayuno (g)</th>
        <th>Comida (g)</th>
        <th>Cena (g)</th>
        <th>Snack (g)</th>
        <th>Rutina (Reps - Descanso)</th>
      </tr>
    </thead>
    <tbody>
      <!-- Aqu칤 se generan los d칤as con JS -->
    </tbody>
  </table>
</main>

<footer>Your life Your way Your Diet</footer>

<script>
// Datos base (simplificados por espacio, reemplaza con +150 comidas y ejercicios reales)
const breakfasts = [
  { name: "Avena con frutas", grams: 150, allergens: [], dislike: false },
  { name: "Huevos revueltos", grams: 120, allergens: ["huevo"], dislike: false },
  { name: "Yogur natural", grams: 100, allergens: ["lactosa"], dislike: false },
  // ... agregar m치s
];
const meals = [
  { name: "Pechuga de pollo con arroz", grams: 200, allergens: [], dislike: false },
  { name: "Pescado al horno", grams: 180, allergens: [], dislike: false },
  { name: "Ensalada verde", grams: 150, allergens: ["nuez"], dislike: false },
  // ... agregar m치s
];
const dinners = [
  { name: "Sopa de verduras", grams: 180, allergens: [], dislike: false },
  { name: "Tortilla integral con aguacate", grams: 160, allergens: [], dislike: false },
  { name: "Pasta integral", grams: 200, allergens: [], dislike: false },
  // ... agregar m치s
];
const snacks = [
  { name: "Nueces", grams: 50, allergens: ["nuez"], dislike: false },
  { name: "Fruta fresca", grams: 120, allergens: [], dislike: false },
  { name: "Barra de prote칤na", grams: 60, allergens: [], dislike: false },
  // ... agregar m치s
];

// Rutinas por grupos musculares con repeticiones y descanso base (simplificado)
const routines = {
  1: [ // Nivel 1 - F치cil
    { group: "Pecho y Tr칤ceps", exercise: "Flexiones", reps: "10-12", rest: "60s" },
    { group: "Piernas y Abdomen", exercise: "Sentadillas", reps: "12-15", rest: "60s" },
    { group: "Espalda y Hombro", exercise: "Remo con banda", reps: "10-12", rest: "60s" },
  ],
  2: [ // Nivel 2 - Medio
    { group: "Pecho y Tr칤ceps", exercise: "Flexiones con aplauso", reps: "15-18", rest: "45s" },
    { group: "Piernas y Abdomen", exercise: "Sentadillas con salto", reps: "15-18", rest: "45s" },
    { group: "Espalda y Hombro", exercise: "Remo con banda fuerte", reps: "12-15", rest: "45s" },
  ],
  // ... hasta nivel 12 con mayor dificultad
};

// Variables para controlar estado
let currentMonth = 1;
let difficultyLevel = 1;

const daysInMonth = 30;

// Funci칩n para elegir comida aleatoria filtrando alergias y dislikes
function chooseMeal(array, allergies=[], dislikes=[]) {
  let filtered = array.filter(item =>
    !item.allergens.some(a => allergies.includes(a)) &&
    !dislikes.includes(item.name)
  );
  if (filtered.length === 0) return { name: "Sin opciones v치lidas", grams: 0 };
  return filtered[Math.floor(Math.random() * filtered.length)];
}

// Funci칩n para generar la tabla
function generateTable() {
  const tbody = document.querySelector("#planTable tbody");
  tbody.innerHTML = "";

  for (let day = 1; day <= daysInMonth; day++) {
    // Elegimos comidas
    let breakfast = chooseMeal(breakfasts);
    let meal = chooseMeal(meals);
    let dinner = chooseMeal(dinners);
    let snack = chooseMeal(snacks);

    // Elegimos rutina seg칰n d칤a y dificultad (ciclo simple)
    let routineGroup = "";
    let routineExercise = "";
    let routineReps = "";
    let routineRest = "";

    const routineSets = routines[difficultyLevel] || routines[1];
    const routineIndex = (day - 1) % routineSets.length;
    const routine = routineSets[routineIndex];
    routineGroup = routine.group;
    routineExercise = routine.exercise;
    routineReps = routine.reps;
    routineRest = routine.rest;

    // Crear fila
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${day}</td>
      <td>${breakfast.name} (${breakfast.grams} g)</td>
      <td>${meal.name} (${meal.grams} g)</td>
      <td>${dinner.name} (${dinner.grams} g)</td>
      <td>${snack.name} (${snack.grams} g)</td>
      <td><b>${routineGroup}</b>: ${routineExercise} - ${routineReps} reps - Descanso ${routineRest}</td>
    `;
    tbody.appendChild(tr);
  }
}

// Funci칩n para animaci칩n peque침a en bot칩n
function explosionEffect(button) {
  const explosion = button.querySelector('.explosion');
  explosion.style.animation = 'none';
  explosion.offsetHeight; // trigger reflow
  explosion.style.animation = 'explode 0.5s ease forwards';
}

// Eventos botones
document.getElementById('btnChangeMeals').addEventListener('click', e => {
  explosionEffect(e.currentTarget);
  generateTable();
});
document.getElementById('btnChangeRoutine').addEventListener('click', e => {
  explosionEffect(e.currentTarget);
  // Para cambiar rutina, solo cambia la tabla ya que rutina depende de dificultad y d칤a
  generateTable();
});
document.getElementById('btnIncreaseDifficulty').addEventListener('click', e => {
  explosionEffect(e.currentTarget);
  difficultyLevel++;
  if (difficultyLevel > 12) difficultyLevel = 1;
  generateTable();
});
document.getElementById('btnIncreaseMonth').addEventListener('click', e => {
  explosionEffect(e.currentTarget);
  currentMonth++;
  if (currentMonth > 12) currentMonth = 1;
  generateTable();
});

// Al iniciar
generateTable();
</script>

</body>
</html>
